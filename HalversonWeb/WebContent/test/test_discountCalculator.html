!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>QUnit Test Suite</title>
<link rel="stylesheet" href="//code.jquery.com/qunit/qunit-1.16.0.css">
</head>
<body>
	<script src="//code.jquery.com/qunit/qunit-1.16.0.js"></script>
	<script
		src="../bower_components/jquery/dist/jquery.js"></script>
	<script src="../js/discountCalculator.js"></script>
	<script>
		function checkDOM(assert, expected, message) {
			var placeholder = $("#alert_placeholder").html();
			assert.ok(placeholder.length > expected, message);
		}
		QUnit.test("calculator.validate()", function(assert) {
			function valid(firstDiscount, secondDiscount, labelPrice, expected,
					message) {
				calculator.clear();
				calculator.validate(firstDiscount, secondDiscount, labelPrice);
				assert.equal(calculator.isError(), expected, message);
				var innerHTMLExpectedLength = 0, message = "DOM for 'alert_placeholder' was modified";
				if (!calculator.isError()) {
					innerHTMLExpectedLength = -1;
					message = "DOM for 'alert_placeholder' was not modified";
				}
				checkDOM(assert, innerHTMLExpectedLength, message);
			}

			valid("blah", 0, 0.00, true, "Invalid First Discount");
			valid(0, "blah", 0.00, true, "Invalid Second Discount");
			valid(0, 0, "blah", true, "Invalid Label Price");
			valid(0, 0, 0.00, false, "All Valid");
		});
		QUnit.test("calculator.calculate()", function(assert) {
			function calc(firstDiscount, secondDiscount, labelPrice, expected, message) {
				calculator.setFirstDiscount(firstDiscount);
				calculator.setSecondDiscount(secondDiscount);
				calculator.setLabelPrice(labelPrice);
				
				calculator.calculate();
				
				assert.equal(calculator.getFinalPrice(), expected, message);
				checkDOM(assert, 0, "DOM for 'alert_placeholder' was modified");
			}
			
			calc(50, 0, 100.23, 50.12, "No Second Discount");
			calc(50, 20, 100.23, 40.09, "With a Second Discount");
		});
	</script>
	<div id="qunit"></div>
	<div id="qunit-fixture">
		<div id="alert_placeholder"></div>
	</div>
</body>
</html>